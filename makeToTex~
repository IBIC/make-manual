#!/bin/bash

if [ $# -eq 1 ] ; then
    IN=$1
    OUT=${1}_texed.txt
elif [ $# -eq 2 ] ; then
    IN=$1
    OUT=$2
else
    echo "Incorrect number of parameters."
    echo "       Usage: $0 input <output>" 
fi

cp $IN temp

sed -e 's/;.*\\/;\\textbackslash/g' -i temp # replace ";\" with ";\textbackslash"

awk 'BEGIN{FS=":"}{if(NF==2) print "\\maker{"$1"}{"$2"}"; else print $0}' temp > $OUT

sed -e 's/[$]/\\\$/g' -i $OUT # replace $ with \$
sed -e 's/%/\\%/g' -i $OUT # replace % with \%
sed -e 's/#/\\#/g' -i $OUT # replace # with \#
sed -e 's/[^[:space:]]$/& \\\\/g' -i $OUT # append \\ to non-blank lines\
sed -e 's/	/\\tab /g' -i $OUT # replace TAB chars with the \tab macro


